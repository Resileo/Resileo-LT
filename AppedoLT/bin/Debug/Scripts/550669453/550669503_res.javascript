function NavigatevMonth(e) { var t = document.getElementById("selectYear1"), n = document.getElementById("selectMonth1"), l = document.getElementById("selectYear2"), a = document.getElementById("selectMonth2"), r = parseInt(t.value), d = parseInt(n.value); if (e) if (r == startYear) { if (0 == d) return; d = 1 == d ? parseInt(d) - 1 : parseInt(d) - 2 } else 0 == d ? (r = parseInt(r) - 1, d = 10) : 1 == d ? (r = parseInt(r) - 1, d = 11) : d = parseInt(d) - 2; else if (r == endYear) { if (d >= 10) return; d = 9 == d ? parseInt(d) + 1 : parseInt(d) + 2 } else 10 == d ? (r = parseInt(r) + 1, d = 0) : 11 == d ? (r = parseInt(r) + 1, d = 1) : d = parseInt(d) + 2; t.value = r, n.value = d, 11 == d ? (l.value = parseInt(r) + 1, a.value = 1) : (l.value = r, a.value = parseInt(d) + 1), showCalenderBody(createCalender(t.value, n.value, !1, !1), createCalender(t.value, n.value, !1, !0)) } function DisplayCalendar(e, t, n, l, a, r, d, s, c, o, i, u, h, g, m) { if ("-" != e && "/" != e) return window.alert("Unsupported seperator character."), void 0; if (calSChar = e, disDateBfr = null, disDateAft = null, ctrlTrigger = document.getElementById(t), ctrlText = document.getElementById(n), afterCallback = u, startYear = l, endYear = a, nextCtrl = m, isDoubleCal = "1" == h ? !0 : !1, null != r && null != d && null != s) { var f = new Date; f.setFullYear(r, d - 1, s), disDateBfr = f } if (null != c && null != o && null != i) { var p = new Date; p.setFullYear(c, o - 1, i), disDateAft = p } if (null != g) { var y = new RegExp("^([0-9]{2})" + calSChar + "([0-9]{2})" + calSChar + "([0-9]{4})$"), w = document.getElementById(g), v = y.exec(w.value); if (null != v) { 0 == v[1].substr(0, 1) && (v[1] = v[1].substr(1, 1)), 0 == v[2].substr(0, 1) && (v[2] = v[2].substr(1, 1)), v[2] = v[2] - 1; var D = new Date; D.setFullYear(v[3], v[2], parseInt(v[1])), disDateBfr = D } } isShown = !0; var b = document.getElementById(t); document.onclick = documentClickHandle, showCalender(b, n) } function documentClickHandle(e) { if (isShown) { var t = window.event ? window.event.srcElement : e.target, n = document.getElementById("dCalenderTable"), l = n.childNodes; if (t == n || t == ctrlText || t == ctrlTrigger || t == ctrlTrigger.firstChild || t == ctrlTrigger.lastChild) return; checkChildsRecursive(l, t) || closeCalender() } } function checkChildsRecursive(e, t) { for (var n = 0; n < e.length; n++) { var l = e[n]; if (l == t) return !0; if (l.hasChildNodes() && checkChildsRecursive(l.childNodes, t)) return !0 } return !1 } function getRealYear(e) { return e.getYear() % 100 + (e.getYear() % 100 < 39 ? 2e3 : 1900) } function getDaysPerMonth(e, t) { return t % 4 == 0 ? t % 100 == 0 && t % 400 != 0 ? monthMaxDays[e] : monthMaxDaysLeap[e] : monthMaxDays[e] } function createCalender(e, t, n, l) { var a = new Date, r = a.getDate(), d = a.getMonth(), s = getRealYear(a); if (!e) var e = s, t = d; isDoubleCal && l && (11 == t ? (e = parseInt(e) + 1, t = 0) : t = parseInt(t) + 1), l ? (document.getElementById("selectYear2").value = e, document.getElementById("selectMonth2").value = t, document.getElementById("secondMonth").innerHTML = getMonth(t) + " " + e) : (document.getElementById("selectYear1").value = e, document.getElementById("selectMonth1").value = t, document.getElementById("firstMonth").innerHTML = getMonth(t) + " " + e); var c = new Date(e, t, 1), o = c.getDay(); continu = !0, firstRow = !0; for (var i = 0, u = 0, h = [], g = 0; u <= getDaysPerMonth(t, e) ;) { if (firstRow) { if (h[g] = document.createElement("TR"), o > 0) for (; o > i;) h[g].appendChild(document.createElement("TD")), i++; firstRow = !1; var u = 1 } if (i % 7 == 0 && (g++, h[g] = document.createElement("TR")), n && u == n && !l) var m = "calenderChoosenDay", f = "choosenDay", p = "Selected day"; else if (u == r && t == d && e == s) var m = "calenderToDay", f = "toDay", p = "This day is today"; else var m = !1, f = "normalDay", p = !1; var y = document.createElement("TD"); y.className = f, m && (y.id = m), p && (y.title = p); var w = !0, v = new Date; if (v.setFullYear(e, t, u), null != disDateBfr && compareDates(v, disDateBfr) < 0) { y.className = "disabledDay"; var w = !1 } if (null != disDateAft && compareDates(v, disDateAft) > 0) { y.className = "disabledDay"; var w = !1 } w && (y.onmouseover = new Function("highLiteDay(this)"), y.onmouseout = new Function("deHighLiteDay(this)"), targetEl ? y.onclick = new Function("pickDate(" + e + ", " + t + ", " + u + ")") : y.style.cursor = "default"), y.appendChild(document.createTextNode(u)), h[g].appendChild(y), i++, u++ } return h } function showCalender(e, t) { lnkEl = e, targetEl = !1, document.getElementById(t) ? targetEl = document.getElementById(t) : document.forms[0].elements[t] && (targetEl = document.forms[0].elements[t]); var n = document.getElementById("dCalenderTable"), l = [0, 0], l = getParentOffset(e, l); n.style.left = l[0] + "px", n.style.top = l[1] + "px"; var a = new RegExp("^([0-9]{2})" + calSChar + "([0-9]{2})" + calSChar + "([0-9]{4})$"), r = a.exec(targetEl.value); null == r ? showCalenderBody(createCalender(!1, !1, !1, !1), createCalender(!1, !1, !1, !0)) : (0 == r[1].substr(0, 1) && (r[1] = r[1].substr(1, 1)), 0 == r[2].substr(0, 1) && (r[2] = r[2].substr(1, 1)), r[2] = r[2] - 1, showCalenderBody(createCalender(r[3], r[2], r[1], !1), createCalender(r[3], r[2], r[1], !0))), n.style.display = "block" } function showCalenderBody(e, t) { for (var n = document.getElementById("calender1") ; n.childNodes[0];) n.removeChild(n.childNodes[0]); for (var l in e) n.appendChild(e[l]); for (var a = document.getElementById("calender2") ; a.childNodes[0];) a.removeChild(a.childNodes[0]); for (var l in t) a.appendChild(t[l]) } function setYears(e, t) { var n = new Date, l = getRealYear(n); e && (startYear = l), t && (endYear = l), document.getElementById("selectYear").options.length = 0; var a = 0; for (y = t; y >= e; y--) document.getElementById("selectYear")[a++] = new Option(y, y) } function hideSelect(e, t) { if (!(t >= 100)) for (var n = 2, l = 0; n > l; l++) { var a = null; if (a = 0 == l ? document.getElementById("selectMonth") : document.getElementById("selectYear"), "selectMonth" == a.id || "selectYear" == a.id) { if ("selectMonth" != a.id && "selectYear" != a.id) { var r = document.getElementById("dCalenderTable"), d = [0, 0], d = getParentOffset(a, d), s = d[0], c = d[0] + a.offsetWidth, o = d[1], i = d[1] + a.offsetHeight, u = r.offsetLeft, h = r.offsetLeft + r.offsetWidth, g = r.offsetTop, m = r.offsetTop + r.offsetHeight; (s >= u && h >= s || h >= c && c >= u || u >= s && c >= h) && (o >= g && m >= o || m >= i && i >= g || g >= o && i >= m) && (hideSelectTags[hideSelectTags.length] = a, a.style.display = "none") } } else a.childNodes.length > 0 && hideSelect(a, t + 1) } } function closeCalender() { isShown = !1, ctrlTrigger = null, ctrlText = null; for (var e = 0; e < hideSelectTags.length; e++) hideSelectTags[e].style.display = "block"; hideSelectTags.length = 0, document.getElementById("dCalenderTable").style.display = "none", document.onclick = null } function highLiteDay(e) { e.className = "hlDay" } function deHighLiteDay(e) { e.className = "calenderToDay" == e.id ? "toDay" : "calenderChoosenDay" == e.id ? "choosenDay" : "normalDay" } function pickDate(e, t, n) { t++, n = 10 > n ? "0" + n : n, t = 10 > t ? "0" + t : t, targetEl ? (targetEl.value = n + calSChar + t + calSChar + e, closeCalender(), "hidden" != lnkEl.style.visibility && lnkEl.focus(), null != afterCallback && afterCallback(), null != nextCtrl && document.getElementById(nextCtrl).focus()) : alert("target for date is not set yet") } function getParentOffset(e, t) { return t[0] += e.offsetLeft, t[1] += e.offsetTop, e.offsetParent && (t = getParentOffset(e.offsetParent, t)), t } function compareDates(e, t) { var n = e.getFullYear(), l = e.getMonth(), a = e.getDate(), r = t.getFullYear(), d = t.getMonth(), s = t.getDate(); return n > r ? 1 : r > n ? -1 : l > d ? 1 : d > l ? -1 : a > s ? 1 : s > a ? -1 : 0 } function get_Date_String(e, t) { var n = e.getFullYear(), l = e.getMonth() + 1, a = e.getDate(), r = ""; return r + (10 > a ? "0" + a : a) + t + (10 > l ? "0" + l : l) + t + n } function get_String_Date(e, t) { var n = e.split(t), l = new Date; return l.setFullYear(n[2], n[1] - 1, n[0]), l } function dateAddDays(e, t) { var n = new Date; if (n.setFullYear(e.getFullYear(), e.getMonth(), e.getDate()), t > 0) n.setDate(n.getDate() + t); else if (0 > t) { var l = -1 * t; n.setDate(n.getDate() - l) } return n } function getMonth(e) { switch (parseInt(e)) { case 0: return "January"; case 1: return "February"; case 2: return "March"; case 3: return "April"; case 4: return "May"; case 5: return "June"; case 6: return "July"; case 7: return "August"; case 8: return "September"; case 9: return "October"; case 10: return "November"; case 11: return "December" } } document.writeln("<table id='dCalenderTable' cellspacing='0' cellpadding='0' border='0' style='display: none; width:421px;'>"), document.writeln("<tbody id='calenderTableHead'>"), document.writeln("<tr><td colspan='14'>"), document.writeln("<table id='ctHead1' border='0' cellspacing='0' cellpadding='0' width='100%'><tr>"), document.writeln("<td id='mPrev' title='Previous Month' class='PrevNxt'><a href='javascript:NavigatevMonth(true)' class='hypLink'>◄</a></td>"), document.writeln("<td colspan='6'>"), document.writeln("<span id='firstMonth'></span><input id='selectMonth1' type='hidden'></input><input id='selectYear1' type='hidden'></input>"), document.writeln("</td>"), document.writeln("<td colspan='6'>"), document.writeln("<span id='secondMonth'></span><input id='selectMonth2' type='hidden'></input><input id='selectYear2' type='hidden'></input>"), document.writeln("</td>"), document.writeln("<td id='mNext' title='Next Month' class='PrevNxt'><a href='javascript:NavigatevMonth(false)' class='hypLink'>►<a></td>"), document.writeln("</td></tr></table>"), document.writeln("</td></tr>"), document.writeln("</tbody>"), document.writeln("<tbody><tr><td style='border-right-style: solid; border-right-width: 1px; border-right-color: #808080;height:0px' colspan='7'>"), document.writeln("<table id='ctHead2' border='0' cellspacing='0' cellpadding='0' width='100%'><tr><td class='wp'>Sun</td><td class='wp'>Mon</td><td class='wp'>Tue</td><td class='wp'>Wed</td><td class='wp'>Thu</td><td class='wp'>Fri</td><td class='wp'>Sat</td></tr></table>"), document.writeln("</td><td style='height:0px' colspan='7'>"), document.writeln("<table id='ctHead3' border='0' cellspacing='0' cellpadding='0' width='100%'><tr><td class='wp'>Sun</td><td class='wp'>Mon</td><td class='wp'>Tue</td><td class='wp'>Wed</td><td class='wp'>Thu</td><td class='wp'>Fri</td><td class='wp'>Sat</td></tr></table>"), document.writeln("</td></tr></tbody>"), document.writeln("<tbody><tr><td colspan='14' style='height:0px'></td></tr></tbody>"), document.writeln("<tbody><tr><td colspan='7' style='border-right-style: solid; border-right-width: 1px; border-right-color: #808080;'>"), document.writeln("<table border='0' cellspacing='0' cellpadding='0' width='100%'><tbody id='calender1'></tbody></table>"), document.writeln("</td><td colspan='7' class='monthBox'>"), document.writeln("<table border='0' cellspacing='0' cellpadding='0' width='100%'><tbody id='calender2'></tbody></table>"), document.writeln("</td></tr></tbody></table>"), monthMaxDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], monthMaxDaysLeap = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], hideSelectTags = []; var isShown = !1, disDateBfr = null, disDateAft = null, calSChar = "/", ctrlTrigger = null, ctrlText = null, afterCallback = null, isDoubleCal = null, startYear = null, endYear = null, nextCtrl = null, lnkEl = null;