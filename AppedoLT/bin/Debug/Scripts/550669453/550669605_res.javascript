function NavigatevMonth(e) { var t = document.getElementById("selectYear"), n = document.getElementById("selectMonth"), l = t.selectedIndex, a = n.selectedIndex, r = t.options.length - 1; if (e) if (l == r) { if (0 == a) return; a -= 1 } else 0 == a ? (l += 1, a = 11) : a -= 1; else if (0 == l) { if (11 == a) return; a += 1 } else 11 == a ? (l -= 1, a = 0) : a += 1; t.selectedIndex = l, n.selectedIndex = a, showCalenderBody(createCalender(t.value, n.selectedIndex, !1)) } function DisplayCalendar(e, t, n, l, a, r, o, d, c, i, s, u) { if ("-" != e && "/" != e) return window.alert("Unsupported seperator character."), void 0; if (calSChar = e, disDateBfr = null, disDateAft = null, ctrlTrigger = document.getElementById(t), ctrlText = document.getElementById(n), afterCallback = u, null != r && null != o && null != d) { var f = new Date; f.setFullYear(r, o - 1, d), disDateBfr = f } if (null != c && null != i && null != s) { var h = new Date; h.setFullYear(c, i - 1, s), disDateAft = h } isShown = !0; var m = document.getElementById(t); document.onclick = documentClickHandle, setYears(l, a), showCalender(m, n) } function documentClickHandle(e) { if (isShown) { var t = window.event ? window.event.srcElement : e.target, n = document.getElementById("calenderTable"), l = n.childNodes; if (t == n || t == ctrlText || t == ctrlTrigger || t == ctrlTrigger.firstChild || t == ctrlTrigger.lastChild) return; checkChildsRecursive(l, t) || closeCalender() } } function checkChildsRecursive(e, t) { for (var n = 0; n < e.length; n++) { var l = e[n]; if (l == t) return !0; if (l.hasChildNodes() && checkChildsRecursive(l.childNodes, t)) return !0 } return !1 } function getRealYear(e) { return e.getYear() % 100 + (e.getYear() % 100 < 39 ? 2e3 : 1900) } function getDaysPerMonth(e, t) { return t % 4 == 0 ? t % 100 == 0 && t % 400 != 0 ? monthMaxDays[e] : monthMaxDaysLeap[e] : monthMaxDays[e] } function createCalender(e, t, n) { var l = new Date, a = l.getDate(), r = l.getMonth(), o = getRealYear(l); if (!e) var e = o, t = r; for (var d = 0, c = 0; c < document.getElementById("selectYear").options.length; c++) if (document.getElementById("selectYear").options[c].value == e) { document.getElementById("selectYear").selectedIndex = c, d = !0; break } d || (document.getElementById("selectYear").selectedIndex = 0, e = document.getElementById("selectYear").options[0].value), document.getElementById("selectMonth").selectedIndex = t; var i = new Date(e, t, 1), s = i.getDay(); continu = !0, firstRow = !0; for (var u = 0, f = 0, h = [], m = 0; f <= getDaysPerMonth(t, e) ;) { if (firstRow) { if (h[m] = document.createElement("TR"), s > 0) for (; s > u;) h[m].appendChild(document.createElement("TD")), u++; firstRow = !1; var f = 1 } if (u % 7 == 0 && (m++, h[m] = document.createElement("TR")), n && f == n) var g = "calenderChoosenDay", y = "choosenDay", p = "Selected day"; else if (f == a && t == r && e == o) var g = "calenderToDay", y = "toDay", p = "This day is today"; else var g = !1, y = "normalDay", p = !1; var v = document.createElement("TD"); v.className = y, g && (v.id = g), p && (v.title = p); var w = !0, D = new Date; if (D.setFullYear(e, t, f), null != disDateBfr && compareDates(D, disDateBfr) < 0) { v.className = "disabledDay"; var w = !1 } if (null != disDateAft && compareDates(D, disDateAft) > 0) { v.className = "disabledDay"; var w = !1 } w && (v.onmouseover = new Function("highLiteDay(this)"), v.onmouseout = new Function("deHighLiteDay(this)"), targetEl ? v.onclick = new Function("pickDate(" + e + ", " + t + ", " + f + ")") : v.style.cursor = "default"), v.appendChild(document.createTextNode(f)), h[m].appendChild(v), u++, f++ } return h } function showCalender(e, t) { lnkEl = e, targetEl = !1, document.getElementById(t) ? targetEl = document.getElementById(t) : document.forms[0].elements[t] && (targetEl = document.forms[0].elements[t]); var n = document.getElementById("calenderTable"), l = [0, 0], l = getParentOffset(e, l); n.style.left = l[0] + "px", n.style.top = l[1] + "px"; var a = new RegExp("^([0-9]{2})" + calSChar + "([0-9]{2})" + calSChar + "([0-9]{4})$"), r = a.exec(targetEl.value); null == r ? (trs = createCalender(!1, !1, !1), showCalenderBody(trs)) : (0 == r[1].substr(0, 1) && (r[1] = r[1].substr(1, 1)), 0 == r[2].substr(0, 1) && (r[2] = r[2].substr(1, 1)), r[2] = r[2] - 1, trs = createCalender(r[3], r[2], r[1]), showCalenderBody(trs)), hideSelect(document.body, 1), n.style.display = "block" } function showCalenderBody(e) { for (var t = document.getElementById("calender") ; t.childNodes[0];) t.removeChild(t.childNodes[0]); for (var n in e) t.appendChild(e[n]) } function setYears(e, t) { var n = new Date, l = getRealYear(n); e && (startYear = l), t && (endYear = l), document.getElementById("selectYear").options.length = 0; var a = 0; for (y = t; y >= e; y--) document.getElementById("selectYear")[a++] = new Option(y, y) } function hideSelect(e, t) { if (!(t >= 100)) for (var n = 2, l = 0; n > l; l++) { var a = null; if (a = 0 == l ? document.getElementById("selectMonth") : document.getElementById("selectYear"), "selectMonth" == a.id || "selectYear" == a.id) { if ("selectMonth" != a.id && "selectYear" != a.id) { var r = document.getElementById("calenderTable"), o = [0, 0], o = getParentOffset(a, o), d = o[0], c = o[0] + a.offsetWidth, i = o[1], s = o[1] + a.offsetHeight, u = r.offsetLeft, f = r.offsetLeft + r.offsetWidth, h = r.offsetTop, m = r.offsetTop + r.offsetHeight; (d >= u && f >= d || f >= c && c >= u || u >= d && c >= f) && (i >= h && m >= i || m >= s && s >= h || h >= i && s >= m) && (hideSelectTags[hideSelectTags.length] = a, a.style.display = "none") } } else a.childNodes.length > 0 && hideSelect(a, t + 1) } } function closeCalender() { isShown = !1, ctrlTrigger = null, ctrlText = null; for (var e = 0; e < hideSelectTags.length; e++) hideSelectTags[e].style.display = "block"; hideSelectTags.length = 0, document.getElementById("calenderTable").style.display = "none", document.onclick = null } function highLiteDay(e) { e.className = "hlDay" } function deHighLiteDay(e) { e.className = "calenderToDay" == e.id ? "toDay" : "calenderChoosenDay" == e.id ? "choosenDay" : "normalDay" } function pickDate(e, t, n) { t++, n = 10 > n ? "0" + n : n, t = 10 > t ? "0" + t : t, targetEl ? (targetEl.value = n + calSChar + t + calSChar + e, closeCalender(), "hidden" != lnkEl.style.visibility && lnkEl.focus(), null != afterCallback && afterCallback()) : alert("target for date is not set yet") } function getParentOffset(e, t) { return t[0] += e.offsetLeft, t[1] += e.offsetTop, e.offsetParent && (t = getParentOffset(e.offsetParent, t)), t } function compareDates(e, t) { var n = e.getFullYear(), l = e.getMonth(), a = e.getDate(), r = t.getFullYear(), o = t.getMonth(), d = t.getDate(); return n > r ? 1 : r > n ? -1 : l > o ? 1 : o > l ? -1 : a > d ? 1 : d > a ? -1 : 0 } function get_Date_String(e, t) { var n = e.getFullYear(), l = e.getMonth() + 1, a = e.getDate(), r = ""; return r + (10 > a ? "0" + a : a) + t + (10 > l ? "0" + l : l) + t + n } function get_String_Date(e, t) { var n = e.split(t), l = new Date; return l.setFullYear(n[2], n[1] - 1, n[0]), l } function dateAddDays(e, t) { var n = new Date; if (n.setFullYear(e.getFullYear(), e.getMonth(), e.getDate()), t > 0) n.setDate(n.getDate() + t); else if (0 > t) { var l = -1 * t; n.setDate(n.getDate() - l) } return n } document.writeln("<table id='calenderTable' cellspacing='0' cellpadding='0' border='0' width='295' style='display: none'>"), document.writeln("<tbody id='calenderTableHead'>"), document.writeln("<tr><td colspan='7'>"), document.writeln("<table id='ctHead1' border='0' cellspacing='0' cellpadding='0' width='100%'><tr><td>"), document.writeln("<td id='mPrev' title='Previous Month' class='PrevNxt'><a href='javascript:NavigatevMonth(true)' class='hypLink'>◄</a></td>"), document.writeln("<td colspan='5'>"), document.writeln("<select id='selectMonth' style='width: 130px' onchange=\"showCalenderBody(createCalender(document.getElementById('selectYear').value, this.selectedIndex, false));\">"), document.writeln("<option value='0'>January</option><option value='1'>February</option><option value='2'>March</option><option value='3'>April</option><option value='4'>May</option><option value='5'>June</option><option value='6'>July</option><option value='7'>August</option><option value='8'>September</option><option value='9'>October</option><option value='10'>November</option><option value='11'>December</option>"), document.writeln("</select>&nbsp;&nbsp;"), document.writeln("<select id='selectYear' style='width: 80px' onchange=\"showCalenderBody(createCalender(this.value, document.getElementById('selectMonth').selectedIndex, false));\"></select>"), document.writeln("</td>"), document.writeln("<td id='mNext' title='Next Month' class='PrevNxt'><a href='javascript:NavigatevMonth(false)' class='hypLink'>►<a></td>"), document.writeln("</td></tr></table>"), document.writeln("</td></tr>"), document.writeln("</tbody>"), document.writeln("<tbody><tr><td style='height:0px' colspan='7'>"), document.writeln("<table id='ctHead2' border='0' cellspacing='0' cellpadding='0' width='100%'><tr><td class='wp'>Sun</td><td class='wp'>Mon</td><td class='wp'>Tue</td><td class='wp'>Wed</td><td class='wp'>Thu</td><td class='wp'>Fri</td><td class='wp'>Sat</td></tr></table>"), document.writeln("</td></tr></tbody>"), document.writeln("<tbody><tr><td colspan='7' style='height:0px'></td></tr></tbody>"), document.writeln("<tbody id='calender'></tbody>"), document.writeln("</table>"), monthMaxDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], monthMaxDaysLeap = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], hideSelectTags = []; var isShown = !1, disDateBfr = null, disDateAft = null, calSChar = "/", ctrlTrigger = null, ctrlText = null, afterCallback = null, lnkEl = null;